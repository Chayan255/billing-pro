generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

enum Role {
  ADMIN
  STAFF
  CASHIER
}

enum PaymentMethod {
  CASH
  UPI
  CARD
}

/* =======================
   USER
======================= */
model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  role      Role
  createdAt DateTime @default(now())
}

/* =======================
   CUSTOMER
======================= */
model Customer {
  id        Int      @id @default(autoincrement())
  name      String
  phone     String?
  gstin     String?   // GST number (optional)
  createdAt DateTime @default(now())

  bills Bill[]
}

/* =======================
   PRODUCT
======================= */
model Product {
  id        Int      @id @default(autoincrement())
  name      String
  sku       String   @unique
  price     Float
  stock     Int
  category  String
  createdAt DateTime @default(now())

  billItems BillItem[]
  cartItems CartItem[]
}

/* =======================
   BILL (GST READY)
======================= */
model Bill {
  id             Int      @id @default(autoincrement())
  totalAmount    Float
  taxableAmount  Float
  cgst           Float
  sgst           Float
  igst           Float
  paymentMethod  String
  customerId     Int?
  createdAt      DateTime @default(now())

  items          BillItem[]
  customer       Customer? @relation(fields: [customerId], references: [id])
}


/* =======================
   BILL ITEM
======================= */
model BillItem {
  id        Int     @id @default(autoincrement())
  billId    Int
  productId Int
  quantity  Int
  price     Float   // price at time of sale

  bill    Bill    @relation(fields: [billId], references: [id])
  product Product @relation(fields: [productId], references: [id])
}

/* =======================
   CART ITEM
======================= */
model CartItem {
  id        Int      @id @default(autoincrement())
  userId    Int
  productId Int
  quantity  Int
  createdAt DateTime @default(now())

  product Product @relation(fields: [productId], references: [id])
}
